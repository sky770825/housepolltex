<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ¿ç”¢è²»ç”¨æ™ºæ…§ä¼°ç®—ä¸­å¿ƒ</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ </text></svg>">
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- è‡ªå®šç¾©æ¨£å¼ -->
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #10b981 0%, #3b82f6 100%);
        }
        .gradient-text {
            background: linear-gradient(135deg, #10b981, #3b82f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-8px);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }
        .tab-active {
            background: linear-gradient(135deg, #10b981, #3b82f6);
            color: white;
            box-shadow: 0 4px 14px 0 rgba(16, 185, 129, 0.4);
        }
        .calculator-section {
            display: none;
        }
        .calculator-section.active {
            display: block;
        }
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }
        .slide-in {
            animation: slideIn 0.5s ease-out;
        }
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        .float-animation {
            animation: float 3s ease-in-out infinite;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-30px); }
            to { opacity: 1; transform: translateX(0); }
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }
        .input-focus:focus {
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
            border-color: #10b981;
        }
        .result-card {
            background: linear-gradient(145deg, #ffffff, #f8fafc);
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
        }
        .result-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .progress-bar {
            background: linear-gradient(90deg, #10b981, #3b82f6);
            transition: width 0.5s ease;
        }
        .tooltip {
            position: relative;
        }
        .tooltip:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #1f2937;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            white-space: nowrap;
            z-index: 1000;
        }
        .dark-mode {
            background: #0f172a;
            color: #f1f5f9;
        }
        .dark-mode .bg-white {
            background: #1e293b;
            color: #f1f5f9;
        }
        .dark-mode .text-gray-600 {
            color: #94a3b8;
        }
        .dark-mode .border-gray-300 {
            border-color: #475569;
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-emerald-50 via-white to-blue-50">
    <!-- å°èˆªæ¬„ -->
    <nav class="glass-effect shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-12 h-12 gradient-bg rounded-full flex items-center justify-center float-animation">
                        <span class="text-white text-2xl">ğŸ </span>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold gradient-text">æˆ¿ç”¢è²»ç”¨æ™ºæ…§ä¼°ç®—ä¸­å¿ƒ</h1>
                        <p class="text-sm text-gray-600">å°ˆæ¥­æˆ¿åœ°ç”¢è¨ˆç®—å·¥å…·</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="flex space-x-2">
                        <button onclick="showCalculator('buyer')" class="px-4 py-2 rounded-lg hover:bg-emerald-100 transition-all duration-300 tab-btn tooltip" data-tab="buyer" data-tooltip="è¨ˆç®—è³¼å±‹ç¸½æˆæœ¬">
                            <span class="mr-2">ğŸ§®</span>è²·æ–¹ä¼°ç®—
                        </button>
                        <button onclick="showCalculator('seller')" class="px-4 py-2 rounded-lg hover:bg-blue-100 transition-all duration-300 tab-btn tooltip" data-tab="seller" data-tooltip="è¨ˆç®—å”®å±‹ç¨…è³¦">
                            <span class="mr-2">ğŸ“ˆ</span>è³£æ–¹ä¼°ç®—
                        </button>
                        <button onclick="showCalculator('screen')" class="px-4 py-2 rounded-lg hover:bg-amber-100 transition-all duration-300 tab-btn tooltip" data-tab="screen" data-tooltip="å°ˆæ¥­ç´—çª—å ±åƒ¹">
                            <span class="mr-2">âœ¨</span>ç´—çª—å ±åƒ¹
                        </button>
                    </div>
                    <div class="flex items-center space-x-2">
                        <button onclick="toggleDarkMode()" class="p-2 rounded-lg hover:bg-gray-100 transition-colors tooltip" data-tooltip="åˆ‡æ›æ·±è‰²æ¨¡å¼">
                            <span id="dark-mode-icon">ğŸŒ™</span>
                        </button>
                        <button onclick="exportResults()" class="p-2 rounded-lg hover:bg-gray-100 transition-colors tooltip" data-tooltip="å°å‡ºçµæœ">
                            <span>ğŸ“Š</span>
                        </button>
                        <button onclick="showHelp()" class="p-2 rounded-lg hover:bg-gray-100 transition-colors tooltip" data-tooltip="ä½¿ç”¨èªªæ˜">
                            <span>â“</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- æ­¡è¿é é¢ -->
    <div id="welcome-page" class="container mx-auto px-4 py-8">
        <div class="max-w-4xl mx-auto text-center">
            <!-- ä¸»è¦æ¨™é¡Œ -->
            <div class="fade-in mb-12">
                <div class="w-28 h-28 gradient-bg rounded-full flex items-center justify-center mx-auto mb-6 pulse-animation">
                    <span class="text-white text-5xl">ğŸ </span>
                </div>
                <h1 class="text-6xl font-bold gradient-text mb-4">æˆ¿ç”¢è²»ç”¨æ™ºæ…§ä¼°ç®—ä¸­å¿ƒ</h1>
                <p class="text-xl text-gray-600 mb-6">å°ˆæ¥­ã€æº–ç¢ºã€æ˜“ç”¨çš„æˆ¿åœ°ç”¢è¨ˆç®—å·¥å…·</p>
                <div class="flex justify-center items-center space-x-4 text-sm text-gray-500">
                    <div class="flex items-center">
                        <span class="w-2 h-2 bg-emerald-500 rounded-full mr-2"></span>
                        å³æ™‚è¨ˆç®—
                    </div>
                    <div class="flex items-center">
                        <span class="w-2 h-2 bg-blue-500 rounded-full mr-2"></span>
                        åœ–è¡¨åˆ†æ
                    </div>
                    <div class="flex items-center">
                        <span class="w-2 h-2 bg-amber-500 rounded-full mr-2"></span>
                        å°ˆæ¥­å ±åƒ¹
                    </div>
                </div>
            </div>

            <!-- åŠŸèƒ½å¡ç‰‡ -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
                <div class="card-hover bg-white rounded-xl p-8 shadow-lg cursor-pointer" onclick="showCalculator('buyer')">
                    <div class="flex justify-between items-start mb-4">
                        <div class="text-5xl">ğŸ§®</div>
                        <div class="bg-emerald-100 text-emerald-800 px-3 py-1 rounded-full text-sm font-semibold">
                            ç†±é–€
                        </div>
                    </div>
                    <h3 class="text-2xl font-bold text-emerald-800 mb-3">è²·æ–¹ä¼°ç®—</h3>
                    <p class="text-gray-600 mb-4">è¨ˆç®—è³¼å±‹ç¸½æˆæœ¬ï¼ŒåŒ…å«è²¸æ¬¾ã€é›œè²»ç­‰æ‰€æœ‰è²»ç”¨</p>
                    <div class="bg-emerald-50 rounded-lg p-4 mb-4">
                        <div class="grid grid-cols-1 gap-2">
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-emerald-700">æˆ¿åƒ¹è¨ˆç®—</span>
                                <div class="w-16 bg-emerald-200 rounded-full h-2">
                                    <div class="bg-emerald-500 h-2 rounded-full w-4/5"></div>
                                </div>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-emerald-700">è²¸æ¬¾åˆ†æ</span>
                                <div class="w-16 bg-emerald-200 rounded-full h-2">
                                    <div class="bg-emerald-500 h-2 rounded-full w-3/4"></div>
                                </div>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-emerald-700">é›œè²»çµ±è¨ˆ</span>
                                <div class="w-16 bg-emerald-200 rounded-full h-2">
                                    <div class="bg-emerald-500 h-2 rounded-full w-full"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="text-center">
                        <span class="text-emerald-600 font-semibold">é»æ“Šé–‹å§‹è¨ˆç®— â†’</span>
                    </div>
                </div>

                <div class="card-hover bg-white rounded-xl p-8 shadow-lg cursor-pointer" onclick="showCalculator('seller')">
                    <div class="flex justify-between items-start mb-4">
                        <div class="text-5xl">ğŸ“ˆ</div>
                        <div class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-semibold">
                            å°ˆæ¥­
                        </div>
                    </div>
                    <h3 class="text-2xl font-bold text-blue-800 mb-3">è³£æ–¹ä¼°ç®—</h3>
                    <p class="text-gray-600 mb-4">è¨ˆç®—å”®å±‹ç¨…è³¦ï¼ŒåŒ…å«æˆ¿åœ°åˆä¸€ç¨…ã€æ‰‹çºŒè²»ç­‰æ‰£é™¤é …ç›®</p>
                    <div class="bg-blue-50 rounded-lg p-4 mb-4">
                        <div class="grid grid-cols-1 gap-2">
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-blue-700">å”®åƒ¹åˆ†æ</span>
                                <div class="w-16 bg-blue-200 rounded-full h-2">
                                    <div class="bg-blue-500 h-2 rounded-full w-5/6"></div>
                                </div>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-blue-700">ç¨…è²»è¨ˆç®—</span>
                                <div class="w-16 bg-blue-200 rounded-full h-2">
                                    <div class="bg-blue-500 h-2 rounded-full w-4/5"></div>
                                </div>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-blue-700">æ·¨æ”¶å…¥è©•ä¼°</span>
                                <div class="w-16 bg-blue-200 rounded-full h-2">
                                    <div class="bg-blue-500 h-2 rounded-full w-full"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="text-center">
                        <span class="text-blue-600 font-semibold">é»æ“Šé–‹å§‹è¨ˆç®— â†’</span>
                    </div>
                </div>

                <div class="card-hover bg-white rounded-xl p-8 shadow-lg cursor-pointer" onclick="showCalculator('screen')">
                    <div class="flex justify-between items-start mb-4">
                        <div class="text-5xl">âœ¨</div>
                        <div class="bg-amber-100 text-amber-800 px-3 py-1 rounded-full text-sm font-semibold">
                            ç‰¹è‰²
                        </div>
                    </div>
                    <h3 class="text-2xl font-bold text-amber-800 mb-3">ç´—çª—å ±åƒ¹</h3>
                    <p class="text-gray-600 mb-4">å°ˆæ¥­ç´—çª—å ±åƒ¹å·¥å…·ï¼Œæ”¯æ´å¤šç¨®è¦æ ¼å’Œæè³ª</p>
                    <div class="bg-amber-50 rounded-lg p-4 mb-4">
                        <div class="grid grid-cols-1 gap-2">
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-amber-700">å°ºå¯¸è¨ˆç®—</span>
                                <div class="w-16 bg-amber-200 rounded-full h-2">
                                    <div class="bg-amber-500 h-2 rounded-full w-3/5"></div>
                                </div>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-amber-700">æè³ªé¸æ“‡</span>
                                <div class="w-16 bg-amber-200 rounded-full h-2">
                                    <div class="bg-amber-500 h-2 rounded-full w-4/5"></div>
                                </div>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-amber-700">å ±åƒ¹ç”Ÿæˆ</span>
                                <div class="w-16 bg-amber-200 rounded-full h-2">
                                    <div class="bg-amber-500 h-2 rounded-full w-full"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="text-center">
                        <span class="text-amber-600 font-semibold">é»æ“Šé–‹å§‹è¨ˆç®— â†’</span>
                    </div>
                </div>
            </div>

            <!-- çµ±è¨ˆé¢æ¿ -->
            <div class="bg-white rounded-xl p-8 shadow-lg mb-8">
                <h2 class="text-2xl font-bold mb-6 text-center">ğŸ“ˆ ä½¿ç”¨çµ±è¨ˆ</h2>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
                    <div class="text-center">
                        <div class="text-3xl font-bold text-emerald-600 mb-2" id="totalCalculations">1,247</div>
                        <p class="text-sm text-gray-600">ç¸½è¨ˆç®—æ¬¡æ•¸</p>
                    </div>
                    <div class="text-center">
                        <div class="text-3xl font-bold text-blue-600 mb-2" id="totalUsers">892</div>
                        <p class="text-sm text-gray-600">æ´»èºç”¨æˆ¶</p>
                    </div>
                    <div class="text-center">
                        <div class="text-3xl font-bold text-amber-600 mb-2" id="avgSavings">15.6%</div>
                        <p class="text-sm text-gray-600">å¹³å‡ç¯€çœ</p>
                    </div>
                    <div class="text-center">
                        <div class="text-3xl font-bold text-purple-600 mb-2" id="satisfaction">98.5%</div>
                        <p class="text-sm text-gray-600">æ»¿æ„åº¦</p>
                    </div>
                </div>
            </div>

            <!-- ç‰¹è‰²èªªæ˜ -->
            <div class="bg-white rounded-xl p-8 shadow-lg">
                <h2 class="text-2xl font-bold mb-6 text-center">âœ¨ ç”¢å“ç‰¹è‰²</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="text-center p-4 rounded-lg bg-gradient-to-br from-emerald-50 to-emerald-100">
                        <div class="text-4xl mb-3">ğŸ¤–</div>
                        <h3 class="font-semibold mb-2 text-emerald-800">æ™ºèƒ½è¨ˆç®—</h3>
                        <p class="text-sm text-gray-600">è‡ªå‹•è¨ˆç®—å„ç¨®è²»ç”¨ï¼Œæä¾›æº–ç¢ºçš„ä¼°ç®—çµæœ</p>
                        <div class="mt-3 text-xs text-emerald-600">
                            âœ“ å³æ™‚æ›´æ–° âœ“ ç²¾ç¢ºè¨ˆç®— âœ“ æ™ºèƒ½å»ºè­°
                        </div>
                    </div>
                    <div class="text-center p-4 rounded-lg bg-gradient-to-br from-blue-50 to-blue-100">
                        <div class="text-4xl mb-3">ğŸ“Š</div>
                        <h3 class="font-semibold mb-2 text-blue-800">åœ–è¡¨åˆ†æ</h3>
                        <p class="text-sm text-gray-600">è¦–è¦ºåŒ–å‘ˆç¾æ•¸æ“šï¼Œè®“è¤‡é›œè³‡è¨Šä¸€ç›®äº†ç„¶</p>
                        <div class="mt-3 text-xs text-blue-600">
                            âœ“ åœ“é¤…åœ– âœ“ é•·æ¢åœ– âœ“ è¶¨å‹¢åˆ†æ
                        </div>
                    </div>
                    <div class="text-center p-4 rounded-lg bg-gradient-to-br from-amber-50 to-amber-100">
                        <div class="text-4xl mb-3">ğŸ’¾</div>
                        <h3 class="font-semibold mb-2 text-amber-800">è³‡æ–™ä¿å­˜</h3>
                        <p class="text-sm text-gray-600">è‡ªå‹•ä¿å­˜è¨ˆç®—çµæœï¼Œæ–¹ä¾¿å¾ŒçºŒæŸ¥çœ‹</p>
                        <div class="mt-3 text-xs text-amber-600">
                            âœ“ æœ¬åœ°å„²å­˜ âœ“ å°å‡ºåŠŸèƒ½ âœ“ æ­·å²è¨˜éŒ„
                        </div>
                    </div>
                </div>
                
                <!-- å¿«æ·éµèªªæ˜ -->
                <div class="mt-8 p-4 bg-gray-50 rounded-lg">
                    <h4 class="font-semibold mb-3 text-center">âŒ¨ï¸ å¿«æ·éµ</h4>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                        <div class="text-center">
                            <kbd class="bg-white px-2 py-1 rounded border">Ctrl + 1</kbd>
                            <p class="text-gray-600 mt-1">è²·æ–¹ä¼°ç®—</p>
                        </div>
                        <div class="text-center">
                            <kbd class="bg-white px-2 py-1 rounded border">Ctrl + 2</kbd>
                            <p class="text-gray-600 mt-1">è³£æ–¹ä¼°ç®—</p>
                        </div>
                        <div class="text-center">
                            <kbd class="bg-white px-2 py-1 rounded border">Ctrl + 3</kbd>
                            <p class="text-gray-600 mt-1">ç´—çª—å ±åƒ¹</p>
                        </div>
                        <div class="text-center">
                            <kbd class="bg-white px-2 py-1 rounded border">Ctrl + H</kbd>
                            <p class="text-gray-600 mt-1">é¡¯ç¤ºèªªæ˜</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- è²·æ–¹ä¼°ç®—é é¢ -->
    <div id="buyer-calculator" class="calculator-section container mx-auto px-4 py-8">
        <div class="max-w-6xl mx-auto">
            <div class="bg-white rounded-xl shadow-lg p-8 fade-in">
                <h2 class="text-3xl font-bold text-emerald-800 mb-8 flex items-center">
                    <span class="text-4xl mr-3">ğŸ§®</span>
                    è²·æ–¹è²»ç”¨ä¼°ç®—
                </h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- è¼¸å…¥å€åŸŸ -->
                    <div class="space-y-6">
                        <div class="bg-emerald-50 rounded-lg p-6">
                            <h3 class="text-xl font-semibold mb-4">åŸºæœ¬è³‡è¨Š</h3>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">æˆ¿å±‹ç¸½åƒ¹ (è¬å…ƒ)</label>
                                <input type="number" id="housePrice" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 input-focus" placeholder="ä¾‹å¦‚ï¼š1500" value="1500">
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">è²¸æ¬¾æˆæ•¸ (%)</label>
                                <input type="range" id="loanRatio" min="0" max="100" value="80" class="w-full">
                                <div class="flex justify-between text-sm text-gray-600">
                                    <span>0%</span>
                                    <span id="loanRatioValue">80%</span>
                                    <span>100%</span>
                                </div>
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">è²¸æ¬¾å¹´é™ (å¹´)</label>
                                <input type="range" id="loanYears" min="1" max="30" value="20" class="w-full">
                                <div class="flex justify-between text-sm text-gray-600">
                                    <span>1å¹´</span>
                                    <span id="loanYearsValue">20å¹´</span>
                                    <span>30å¹´</span>
                                </div>
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">è²¸æ¬¾åˆ©ç‡ (%)</label>
                                <input type="range" id="interestRate" min="0.5" max="5" step="0.1" value="2.1" class="w-full">
                                <div class="flex justify-between text-sm text-gray-600">
                                    <span>0.5%</span>
                                    <span id="interestRateValue">2.1%</span>
                                    <span>5%</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-blue-50 rounded-lg p-6">
                            <h3 class="text-xl font-semibold mb-4">é›œé …è²»ç”¨</h3>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">ä»£æ›¸è²» (å…ƒ)</label>
                                    <input type="number" id="serviceFee" class="w-full px-3 py-2 border border-gray-300 rounded-lg input-focus" placeholder="15000" value="15000">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">å…¬è­‰è²» (å…ƒ)</label>
                                    <input type="number" id="notaryFee" class="w-full px-3 py-2 border border-gray-300 rounded-lg input-focus" placeholder="8000" value="8000">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">ä»²ä»‹è²» (å…ƒ)</label>
                                    <input type="number" id="agentFee" class="w-full px-3 py-2 border border-gray-300 rounded-lg input-focus" placeholder="30000" value="30000">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">å¥‘ç¨… (å…ƒ)</label>
                                    <input type="number" id="contractTax" class="w-full px-3 py-2 border border-gray-300 rounded-lg input-focus" placeholder="45000" value="45000">
                                </div>
                            </div>
                        </div>
                        
                        <button onclick="calculateBuyerWithChart()" class="w-full bg-gradient-to-r from-emerald-500 to-blue-500 text-white py-3 px-6 rounded-lg font-semibold hover:shadow-lg transition-all pulse-animation">
                            ğŸ§® è¨ˆç®—ç¸½è²»ç”¨ + åœ–è¡¨åˆ†æ
                        </button>
                    </div>
                    
                    <!-- çµæœå€åŸŸ -->
                    <div class="bg-gray-50 rounded-lg p-6">
                        <h3 class="text-xl font-semibold mb-4">è¨ˆç®—çµæœ</h3>
                        <div id="buyer-results" class="space-y-4">
                            <div class="text-center text-gray-500 py-8">
                                <div class="text-4xl mb-2">ğŸ“Š</div>
                                <p>è«‹è¼¸å…¥æˆ¿å±‹åƒ¹æ ¼é–‹å§‹è¨ˆç®—</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- è³£æ–¹ä¼°ç®—é é¢ -->
    <div id="seller-calculator" class="calculator-section container mx-auto px-4 py-8">
        <div class="max-w-6xl mx-auto">
            <div class="bg-white rounded-xl shadow-lg p-8 fade-in">
                <h2 class="text-3xl font-bold text-blue-800 mb-8 flex items-center">
                    <span class="text-4xl mr-3">ğŸ“ˆ</span>
                    è³£æ–¹æ·¨æ”¶å…¥ä¼°ç®—
                </h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- è¼¸å…¥å€åŸŸ -->
                    <div class="space-y-6">
                        <div class="bg-blue-50 rounded-lg p-6">
                            <h3 class="text-xl font-semibold mb-4">åŸºæœ¬è³‡è¨Š</h3>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">å”®åƒ¹ (è¬å…ƒ)</label>
                                <input type="number" id="salePrice" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 input-focus" placeholder="ä¾‹å¦‚ï¼š2000" value="2000">
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">è³¼å…¥åƒ¹æ ¼ (è¬å…ƒ)</label>
                                <input type="number" id="purchasePrice" class="w-full px-4 py-2 border border-gray-300 rounded-lg input-focus" placeholder="ä¾‹å¦‚ï¼š1500" value="1500">
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">è³¼å…¥æ—¥æœŸ</label>
                                <input type="date" id="purchaseDate" class="w-full px-4 py-2 border border-gray-300 rounded-lg input-focus">
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">å‡ºå”®æ—¥æœŸ</label>
                                <input type="date" id="saleDate" class="w-full px-4 py-2 border border-gray-300 rounded-lg input-focus">
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">æŒæœ‰æœŸé–“ (è‡ªå‹•è¨ˆç®—)</label>
                                <input type="text" id="holdYears" readonly class="w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-100" placeholder="å°‡è‡ªå‹•è¨ˆç®—">
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">è²¸æ¬¾é¤˜é¡ (è¬å…ƒ)</label>
                                <input type="number" id="loanBalance" class="w-full px-4 py-2 border border-gray-300 rounded-lg input-focus" placeholder="ä¾‹å¦‚ï¼š800" value="800">
                                <p class="text-xs text-gray-500 mt-1">è³£æˆ¿æ™‚éœ€å…ˆå„Ÿé‚„çš„è²¸æ¬¾é‡‘é¡</p>
                            </div>
                            
                            <div class="mb-4">
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" id="isSelfUsed" class="rounded border-gray-300">
                                    <span class="text-sm font-medium text-gray-700">è‡ªä½æ»¿6å¹´ï¼ˆäº«400è¬å…ç¨…é¡ï¼‰</span>
                                </label>
                            </div>
                            
                            <div class="mb-4">
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" id="hasRegistered" class="rounded border-gray-300">
                                    <span class="text-sm font-medium text-gray-700">å·²è¨­ç±ï¼ˆè‡ªä½è­‰æ˜ï¼‰</span>
                                </label>
                            </div>
                            
                            <div class="mb-4">
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" id="hasRented" class="rounded border-gray-300">
                                    <span class="text-sm font-medium text-gray-700">æœ‰å‡ºç§Ÿ/ç‡Ÿæ¥­ä½¿ç”¨</span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="bg-amber-50 rounded-lg p-6">
                            <h3 class="text-xl font-semibold mb-4">è²»ç”¨é …ç›®ï¼ˆå¯æ‰£é™¤ï¼‰</h3>
                            <p class="text-xs text-amber-700 mb-4">â€» ä»¥ä¸‹è²»ç”¨å¯å¾æˆ¿åœ°åˆä¸€ç¨…ä¸­æ‰£é™¤</p>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">ä»²ä»‹è²»ç‡ (%)</label>
                                    <input type="range" id="agentRate" min="0" max="5" step="0.1" value="2" class="w-full">
                                    <span id="agentRateValue" class="text-sm text-gray-600">2%</span>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">å…¬è­‰è²» (å…ƒ)</label>
                                    <input type="number" id="sellerNotaryFee" class="w-full px-3 py-2 border border-gray-300 rounded-lg input-focus" placeholder="15000" value="15000">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">ä»£æ›¸è²» (å…ƒ)</label>
                                    <input type="number" id="sellerServiceFee" class="w-full px-3 py-2 border border-gray-300 rounded-lg input-focus" placeholder="12000" value="12000">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">å…¶ä»–è²»ç”¨ (å…ƒ)</label>
                                    <input type="number" id="otherFees" class="w-full px-3 py-2 border border-gray-300 rounded-lg input-focus" placeholder="5000" value="5000">
                                </div>
                            </div>
                        </div>
                        
                        <button onclick="calculateSeller()" class="w-full bg-gradient-to-r from-blue-500 to-purple-500 text-white py-3 px-6 rounded-lg font-semibold hover:shadow-lg transition-all">
                            ğŸ“Š é–‹å§‹è¨ˆç®—ç¨…è³¦
                        </button>
                    </div>
                    
                    <!-- çµæœå€åŸŸ -->
                    <div class="bg-gray-50 rounded-lg p-6">
                        <h3 class="text-xl font-semibold mb-4">è¨ˆç®—çµæœ</h3>
                        <div id="seller-results" class="space-y-4">
                            <div class="text-center text-gray-500 py-8">
                                <div class="text-4xl mb-2">ğŸ“ˆ</div>
                                <p>è«‹è¼¸å…¥å”®åƒ¹å’Œè³¼å…¥åƒ¹æ ¼é–‹å§‹è¨ˆç®—</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ç´—çª—å ±åƒ¹é é¢ -->
    <div id="screen-calculator" class="calculator-section container mx-auto px-4 py-8">
        <div class="max-w-6xl mx-auto">
            <div class="bg-white rounded-xl shadow-lg p-8 fade-in">
                <h2 class="text-3xl font-bold text-amber-800 mb-8 flex items-center">
                    <span class="text-4xl mr-3">âœ¨</span>
                    ç´—çª—å°ˆæ¥­å ±åƒ¹
                </h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- è¼¸å…¥å€åŸŸ -->
                    <div class="space-y-6">
                        <div class="bg-amber-50 rounded-lg p-6">
                            <h3 class="text-xl font-semibold mb-4">ç´—çª—è¦æ ¼</h3>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">ç´—çª—é¡å‹</label>
                                <select id="screenType" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500">
                                    <option value="normal">å¹³ç´—çª—</option>
                                    <option value="roller">æ²ç°¾ç´—çª—</option>
                                    <option value="magnetic">ç£å¸ç´—çª—</option>
                                    <option value="folding">æŠ˜ç–Šç´—çª—</option>
                                </select>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">å¯¬åº¦ (å…¬åˆ†)</label>
                                    <input type="number" id="screenWidth" class="w-full px-3 py-2 border border-gray-300 rounded-lg" placeholder="120">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">é«˜åº¦ (å…¬åˆ†)</label>
                                    <input type="number" id="screenHeight" class="w-full px-3 py-2 border border-gray-300 rounded-lg" placeholder="180">
                                </div>
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">æ•¸é‡</label>
                                <input type="number" id="screenQuantity" min="1" value="1" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">æè³ªç­‰ç´š</label>
                                <select id="materialGrade" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                                    <option value="standard">æ¨™æº–ç´š</option>
                                    <option value="premium">é«˜ç´š</option>
                                    <option value="luxury">è±ªè¯ç´š</option>
                                </select>
                            </div>
                        </div>
                        
                        <button onclick="calculateScreen()" class="w-full bg-gradient-to-r from-amber-500 to-orange-500 text-white py-3 px-6 rounded-lg font-semibold hover:shadow-lg transition-all">
                            âœ¨ ç”Ÿæˆå ±åƒ¹
                        </button>
                    </div>
                    
                    <!-- çµæœå€åŸŸ -->
                    <div class="bg-gray-50 rounded-lg p-6">
                        <h3 class="text-xl font-semibold mb-4">å ±åƒ¹çµæœ</h3>
                        <div id="screen-results" class="space-y-4">
                            <div class="text-center text-gray-500 py-8">
                                <div class="text-4xl mb-2">âœ¨</div>
                                <p>è«‹è¼¸å…¥ç´—çª—è¦æ ¼é–‹å§‹è¨ˆç®—</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- åº•éƒ¨å¿«æ·æŒ‰éˆ•å€åŸŸ -->
    <footer class="bg-gradient-to-r from-gray-900 via-gray-800 to-gray-900 text-white py-12 mt-16">
        <div class="container mx-auto px-4">
            <!-- é›»è…¦ç‰ˆæ©«å¹… -->
            <div class="hidden md:block mb-8">
                <div class="bg-gradient-to-r from-green-600 to-blue-600 rounded-2xl p-6 text-center">
                    <div class="flex items-center justify-center space-x-4 mb-4">
                        <div class="w-16 h-16 bg-white rounded-full flex items-center justify-center">
                            <span class="text-3xl">ğŸ </span>
                        </div>
                        <div class="text-left">
                            <h3 class="text-2xl font-bold">ä½å•†æ¥Šæ¢…å¤§é †åº—</h3>
                            <p class="text-lg opacity-90">å­è²ã€æ¿¬ç‘’å®˜æ–¹å¸³è™Ÿ</p>
                            <p class="text-sm opacity-75">å°ˆæ¥­æˆ¿å±‹è²¸æ¬¾è«®è©¢æœå‹™</p>
                        </div>
                    </div>
                    <a href="https://line.me/R/ti/p/@931aeinu" target="_blank" 
                       class="inline-flex items-center bg-green-500 hover:bg-green-600 text-white px-8 py-3 rounded-full font-semibold transition-all duration-300 hover:scale-105">
                        <span class="text-2xl mr-3">ğŸ’¬</span>
                        æ­¡è¿åŠ å…¥ LINE æ´½è©¢
                        <span class="ml-2">â†’</span>
                    </a>
                </div>
            </div>
            
            <!-- æ‰‹æ©Ÿç‰ˆå®˜æ–¹å¸³è™Ÿ -->
            <div class="md:hidden mb-6">
                <div class="bg-gradient-to-r from-green-600 to-blue-600 rounded-xl p-4 text-center">
                    <div class="flex items-center justify-center space-x-3 mb-3">
                        <div class="w-12 h-12 bg-white rounded-full flex items-center justify-center">
                            <span class="text-2xl">ğŸ </span>
                        </div>
                        <div class="text-left">
                            <h3 class="text-lg font-bold">ä½å•†æ¥Šæ¢…å¤§é †åº—</h3>
                            <p class="text-sm opacity-90">å­è²ã€æ¿¬ç‘’å®˜æ–¹å¸³è™Ÿ</p>
                        </div>
                    </div>
                    <a href="https://line.me/R/ti/p/@931aeinu" target="_blank" 
                       class="inline-flex items-center bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded-full font-semibold transition-all duration-300">
                        <span class="text-xl mr-2">ğŸ’¬</span>
                        LINE å®˜æ–¹å¸³è™Ÿ
                    </a>
                </div>
            </div>
            
            <!-- å…¶ä»–æœå‹™æŒ‰éˆ• -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <!-- TIKTOK çŸ­å½±éŸ³ -->
                <a href="https://www.tiktok.com/@aihouse168" target="_blank" 
                   class="bg-gradient-to-br from-pink-500 to-red-500 hover:from-pink-600 hover:to-red-600 rounded-xl p-6 text-center transition-all duration-300 hover:scale-105 hover:shadow-xl group">
                    <div class="text-4xl mb-3 group-hover:scale-110 transition-transform">ğŸµ</div>
                    <h4 class="text-lg font-bold mb-2">å­è² TIKTOK</h4>
                    <p class="text-sm opacity-90 mb-3">çŸ­å½±éŸ³åˆ†äº«</p>
                    <div class="bg-white/20 rounded-lg px-3 py-1 text-xs">
                        é»æ“Šè§€çœ‹ç²¾å½©å…§å®¹
                    </div>
                </a>
                
                <!-- è¡ŒéŠ·å¿«æ‰‹ -->
                <a href="https://aicoinmaker.com/?REFCODE=Y89RCI" target="_blank" 
                   class="bg-gradient-to-br from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 rounded-xl p-6 text-center transition-all duration-300 hover:scale-105 hover:shadow-xl group">
                    <div class="text-4xl mb-3 group-hover:scale-110 transition-transform">âš¡</div>
                    <h4 class="text-lg font-bold mb-2">è¡ŒéŠ·å¿«æ‰‹</h4>
                    <p class="text-sm opacity-90 mb-3">è‡ªå‹•è‡‰æ›¸ç¤¾åœ˜ç™¼æ–‡</p>
                    <div class="bg-white/20 rounded-lg px-3 py-1 text-xs">
                        æå‡æ›å…‰åº¦
                    </div>
                </a>
                
                <!-- FADOUBLE æ•¸ä½è¡ŒéŠ·åç‰‡ -->
                <a href="https://liff.line.me/1656637679-emAoB1GK/invite/U99c3cb27739fa3d50ac9e3ccd6ac7e7b" target="_blank" 
                   class="bg-gradient-to-br from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700 rounded-xl p-6 text-center transition-all duration-300 hover:scale-105 hover:shadow-xl group">
                    <div class="text-4xl mb-3 group-hover:scale-110 transition-transform">ğŸ“‡</div>
                    <h4 class="text-lg font-bold mb-2">FADOUBLE</h4>
                    <p class="text-sm opacity-90 mb-3">æ•¸ä½è¡ŒéŠ·åç‰‡</p>
                    <div class="bg-white/20 rounded-lg px-3 py-1 text-xs">
                        å°ˆæ¥­å½¢è±¡å±•ç¤º
                    </div>
                </a>
            </div>
            
            <!-- ç‰ˆæ¬Šä¿¡æ¯ -->
            <div class="mt-8 pt-6 border-t border-gray-700 text-center text-sm text-gray-400">
                <p>Â© 2025 æˆ¿ç”¢è²»ç”¨æ™ºæ…§ä¼°ç®—ä¸­å¿ƒ - ä½å•†æ¥Šæ¢…å¤§é †åº—å°ˆæ¥­æœå‹™</p>
                <p class="mt-2">å°ˆæ¥­æˆ¿å±‹è²¸æ¬¾è«®è©¢ | æˆ¿åœ°ç”¢æŠ•è³‡åˆ†æ | æ•¸ä½è¡ŒéŠ·è§£æ±ºæ–¹æ¡ˆ</p>
            </div>
        </div>
    </footer>

    <!-- è¿”å›æŒ‰éˆ• -->
    <div class="fixed bottom-8 right-8 z-50">
        <button onclick="showWelcome()" class="bg-white shadow-lg rounded-full p-4 hover:shadow-xl transition-all hover:scale-110">
            <span class="text-2xl">ğŸ </span>
        </button>
    </div>

    <!-- JavaScript -->
    <script>
        // é é¢åˆ‡æ›åŠŸèƒ½
        function showWelcome() {
            document.getElementById('welcome-page').style.display = 'block';
            document.getElementById('buyer-calculator').classList.remove('active');
            document.getElementById('seller-calculator').classList.remove('active');
            document.getElementById('screen-calculator').classList.remove('active');
            
            // é‡ç½®æŒ‰éˆ•ç‹€æ…‹
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('tab-active');
            });
        }
        
        function showCalculator(type) {
            document.getElementById('welcome-page').style.display = 'none';
            document.getElementById('buyer-calculator').classList.remove('active');
            document.getElementById('seller-calculator').classList.remove('active');
            document.getElementById('screen-calculator').classList.remove('active');
            
            document.getElementById(type + '-calculator').classList.add('active');
            
            // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('tab-active');
            });
            document.querySelector(`[data-tab="${type}"]`).classList.add('tab-active');
        }
        
        // æ»‘æ¡¿å€¼æ›´æ–°
        document.getElementById('loanRatio').addEventListener('input', function() {
            document.getElementById('loanRatioValue').textContent = this.value + '%';
        });
        
        document.getElementById('loanYears').addEventListener('input', function() {
            document.getElementById('loanYearsValue').textContent = this.value + 'å¹´';
        });
        
        document.getElementById('interestRate').addEventListener('input', function() {
            document.getElementById('interestRateValue').textContent = this.value + '%';
        });
        
        document.getElementById('agentRate').addEventListener('input', function() {
            document.getElementById('agentRateValue').textContent = this.value + '%';
        });
        
        // è²·æ–¹è¨ˆç®—åŠŸèƒ½
        function calculateBuyer() {
            const housePrice = parseFloat(document.getElementById('housePrice').value) * 10000;
            const loanRatio = parseFloat(document.getElementById('loanRatio').value) / 100;
            const loanYears = parseInt(document.getElementById('loanYears').value);
            const interestRate = parseFloat(document.getElementById('interestRate').value) / 100;
            const serviceFee = parseFloat(document.getElementById('serviceFee').value) || 0;
            const notaryFee = parseFloat(document.getElementById('notaryFee').value) || 0;
            const agentFee = parseFloat(document.getElementById('agentFee').value) || 0;
            const contractTax = parseFloat(document.getElementById('contractTax').value) || 0;
            
            if (!housePrice || housePrice <= 0) {
                alert('è«‹è¼¸å…¥æœ‰æ•ˆçš„æˆ¿å±‹åƒ¹æ ¼');
                return;
            }
            
            // åŸºæœ¬è¨ˆç®—
            const loanAmount = housePrice * loanRatio;
            const downPayment = housePrice - loanAmount;
            
            // è²¸æ¬¾è¨ˆç®—ï¼ˆæœˆåˆ©ç‡ï¼‰
            const monthlyRate = interestRate / 12;
            const totalMonths = loanYears * 12;
            
            // è¨ˆç®—æœˆä»˜é‡‘é¡
            let monthlyPayment = 0;
            if (loanAmount > 0 && monthlyRate > 0) {
                monthlyPayment = loanAmount * (monthlyRate * Math.pow(1 + monthlyRate, totalMonths)) / (Math.pow(1 + monthlyRate, totalMonths) - 1);
            } else if (loanAmount > 0) {
                // ç„¡åˆ©æ¯æƒ…æ³
                monthlyPayment = loanAmount / totalMonths;
            }
            
            // ç¸½åˆ©æ¯è¨ˆç®—
            const totalInterest = (monthlyPayment * totalMonths) - loanAmount;
            
            // é›œé …è²»ç”¨è¨ˆç®—
            const totalFees = serviceFee + notaryFee + agentFee + contractTax;
            
            // ç¸½æˆæœ¬è¨ˆç®—ï¼ˆåŒ…å«è‡ªå‚™æ¬¾å’Œé›œè²»ï¼‰
            const totalCost = downPayment + totalFees;
            
            const results = `
                <div class="space-y-4">
                    <div class="bg-white rounded-lg p-4 border-l-4 border-emerald-500">
                        <h4 class="font-semibold text-emerald-800 mb-2">ğŸ’° æˆ¿å±‹åŸºæœ¬è³‡è¨Š</h4>
                        <div class="grid grid-cols-2 gap-2 text-sm">
                            <div>æˆ¿å±‹ç¸½åƒ¹ï¼š</div>
                            <div class="font-semibold text-lg">${(housePrice / 10000).toFixed(1)} è¬å…ƒ</div>
                            <div>è²¸æ¬¾æˆæ•¸ï¼š</div>
                            <div class="font-semibold">${(loanRatio * 100).toFixed(0)}%</div>
                            <div>è²¸æ¬¾é‡‘é¡ï¼š</div>
                            <div class="font-semibold text-blue-600">${(loanAmount / 10000).toFixed(1)} è¬å…ƒ</div>
                            <div>è‡ªå‚™æ¬¾ï¼š</div>
                            <div class="font-semibold text-red-600">${(downPayment / 10000).toFixed(1)} è¬å…ƒ</div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4 border-l-4 border-blue-500">
                        <h4 class="font-semibold text-blue-800 mb-2">ğŸ¦ è²¸æ¬¾è©³ç´°è³‡è¨Š</h4>
                        <div class="grid grid-cols-2 gap-2 text-sm">
                            <div>è²¸æ¬¾å¹´é™ï¼š</div>
                            <div class="font-semibold">${loanYears} å¹´</div>
                            <div>å¹´åˆ©ç‡ï¼š</div>
                            <div class="font-semibold">${(interestRate * 100).toFixed(2)}%</div>
                            <div>æœˆä»˜é‡‘é¡ï¼š</div>
                            <div class="font-semibold text-lg text-blue-600">${Math.round(monthlyPayment).toLocaleString()} å…ƒ</div>
                            <div>ç¸½åˆ©æ¯ï¼š</div>
                            <div class="font-semibold text-orange-600">${(totalInterest / 10000).toFixed(1)} è¬å…ƒ</div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4 border-l-4 border-amber-500">
                        <h4 class="font-semibold text-amber-800 mb-2">ğŸ“‹ è³¼å±‹é›œé …è²»ç”¨</h4>
                        <div class="grid grid-cols-2 gap-2 text-sm">
                            <div>ä»£æ›¸è²»ï¼š</div>
                            <div class="font-semibold">${serviceFee.toLocaleString()} å…ƒ</div>
                            <div>å…¬è­‰è²»ï¼š</div>
                            <div class="font-semibold">${notaryFee.toLocaleString()} å…ƒ</div>
                            <div>ä»²ä»‹è²»ï¼š</div>
                            <div class="font-semibold">${agentFee.toLocaleString()} å…ƒ</div>
                            <div>å¥‘ç¨…ï¼š</div>
                            <div class="font-semibold">${contractTax.toLocaleString()} å…ƒ</div>
                            <div class="font-bold text-lg">é›œè²»ç¸½è¨ˆï¼š</div>
                            <div class="font-bold text-lg text-red-600">${totalFees.toLocaleString()} å…ƒ</div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-r from-emerald-500 to-blue-500 text-white rounded-lg p-6 text-center">
                        <h3 class="text-xl font-bold mb-2">ğŸ¯ è³¼å±‹è³‡é‡‘éœ€æ±‚</h3>
                        <div class="text-3xl font-bold">${(totalCost / 10000).toFixed(1)} è¬å…ƒ</div>
                        <p class="text-sm opacity-90 mt-2">è‡ªå‚™æ¬¾ + é›œé …è²»ç”¨ï¼ˆä¸å«æ¯æœˆæˆ¿è²¸ï¼‰</p>
                    </div>
                    
                    <div class="bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg p-6 text-center">
                        <h3 class="text-xl font-bold mb-2">ğŸ’³ æ¯æœˆè² æ“”</h3>
                        <div class="text-3xl font-bold">${Math.round(monthlyPayment).toLocaleString()} å…ƒ</div>
                        <p class="text-sm opacity-90 mt-2">æˆ¿è²¸æœˆä»˜é‡‘é¡</p>
                    </div>
                </div>
            `;
            
            document.getElementById('buyer-results').innerHTML = results;
        }
        
        // è³£æ–¹è¨ˆç®—åŠŸèƒ½
        function calculateSeller() {
            const salePrice = parseFloat(document.getElementById('salePrice').value) * 10000;
            const purchasePrice = parseFloat(document.getElementById('purchasePrice').value) * 10000;
            
            // å¾è‡ªå‹•è¨ˆç®—çš„æŒæœ‰æœŸé–“ä¸­æå–æ•¸å­—
            const holdYearsText = document.getElementById('holdYears').value;
            const holdYears = parseFloat(holdYearsText.replace(' å¹´', '')) || 0;
            const loanBalance = parseFloat(document.getElementById('loanBalance').value) * 10000 || 0;
            const isSelfUsed = document.getElementById('isSelfUsed').checked;
            const hasRegistered = document.getElementById('hasRegistered').checked;
            const hasRented = document.getElementById('hasRented').checked;
            const agentRate = parseFloat(document.getElementById('agentRate').value) / 100;
            const notaryFee = parseFloat(document.getElementById('sellerNotaryFee').value) || 0;
            const serviceFee = parseFloat(document.getElementById('sellerServiceFee').value) || 0;
            const otherFees = parseFloat(document.getElementById('otherFees').value) || 0;
            
            if (!salePrice || !purchasePrice || salePrice <= 0 || purchasePrice <= 0) {
                alert('è«‹è¼¸å…¥æœ‰æ•ˆçš„å”®åƒ¹å’Œè³¼å…¥åƒ¹æ ¼');
                return;
            }
            
            if (holdYears <= 0) {
                alert('è«‹é¸æ“‡è³¼å…¥æ—¥æœŸå’Œå‡ºå”®æ—¥æœŸï¼Œç³»çµ±å°‡è‡ªå‹•è¨ˆç®—æŒæœ‰æœŸé–“');
                return;
            }
            
            // åŸºæœ¬è¨ˆç®—
            const profit = salePrice - purchasePrice;
            const agentFee = salePrice * agentRate;
            const totalFees = agentFee + notaryFee + serviceFee + otherFees;
            
            // è¨ˆç®—å¯¦éš›å¯ç”¨è³‡é‡‘ï¼ˆæ‰£é™¤è²¸æ¬¾é¤˜é¡ï¼‰
            const availableFunds = salePrice - loanBalance;
            
            // æˆ¿åœ°åˆä¸€ç¨…è¨ˆç®—ï¼ˆ2024å¹´æœ€æ–°ç¨…åˆ¶ + è‡ªä½å…ç¨…é¡ï¼‰
            let capitalGainsTax = 0;
            let taxRate = 0;
            let taxInfo = '';
            let taxExemption = 0;
            
            if (profit <= 0) {
                // è™§æä¸èª²ç¨…
                capitalGainsTax = 0;
                taxRate = 0;
                taxInfo = 'è™§æä¸èª²ç¨…';
            } else {
                // è¨ˆç®—æŒæœ‰æœŸé–“ï¼ˆç²¾ç¢ºåˆ°æœˆï¼‰
                const holdMonths = holdYears * 12;
                
                // è‡ªä½æ»¿6å¹´å…ç¨…é¡ï¼ˆæˆ¿åœ°åˆä¸€ç¨…2.0ï¼‰
                // æ¢ä»¶ï¼šè‡ªä½æ»¿6å¹´ + å·²è¨­ç± + ç„¡å‡ºç§Ÿç‡Ÿæ¥­
                if (isSelfUsed && holdYears >= 6 && hasRegistered && !hasRented) {
                    taxExemption = 4000000; // 400è¬å…ç¨…é¡
                    if (profit <= taxExemption) {
                        // ç²åˆ©åœ¨å…ç¨…é¡å…§
                        taxRate = 0; // å…ç¨…
                        capitalGainsTax = 0;
                        taxInfo = 'è‡ªä½æ»¿6å¹´+è¨­ç±+ç„¡å‡ºç§Ÿï¼Œç²åˆ©åœ¨å…ç¨…é¡å…§';
                    } else {
                        // è¶…éå…ç¨…é¡éƒ¨åˆ†èª²ç¨…
                        const taxableProfit = profit - taxExemption;
                        taxRate = 0.10; // è‡ªä½æ»¿6å¹´è¶…éå…ç¨…é¡éƒ¨åˆ†ï¼š10%
                        taxInfo = 'è‡ªä½æ»¿6å¹´+è¨­ç±+ç„¡å‡ºç§Ÿï¼Œè¶…éå…ç¨…é¡éƒ¨åˆ†';
                        capitalGainsTax = taxableProfit * taxRate;
                    }
                } else if (isSelfUsed && holdYears >= 6 && hasRegistered && hasRented) {
                    // è‡ªä½æ»¿6å¹´ä½†æœ‰å‡ºç§Ÿï¼Œç¨…ç‡æé«˜
                    if (holdMonths < 24) {
                        taxRate = 0.45;
                        taxInfo = 'è‡ªä½æ»¿6å¹´ä½†æœ‰å‡ºç§Ÿï¼Œæœªæ»¿2å¹´';
                    } else if (holdMonths < 60) {
                        taxRate = 0.35;
                        taxInfo = 'è‡ªä½æ»¿6å¹´ä½†æœ‰å‡ºç§Ÿï¼Œ2-5å¹´';
                    } else if (holdMonths < 120) {
                        taxRate = 0.20;
                        taxInfo = 'è‡ªä½æ»¿6å¹´ä½†æœ‰å‡ºç§Ÿï¼Œ5-10å¹´';
                    } else {
                        taxRate = 0.15;
                        taxInfo = 'è‡ªä½æ»¿6å¹´ä½†æœ‰å‡ºç§Ÿï¼Œ10å¹´ä»¥ä¸Š';
                    }
                    capitalGainsTax = profit * taxRate;
                } else {
                    // ä¸€èˆ¬æƒ…æ³çš„ç¨…ç‡
                    if (holdMonths < 24) {
                        // 2å¹´å…§ï¼š45%
                        taxRate = 0.45;
                        taxInfo = 'æŒæœ‰æœªæ»¿2å¹´';
                    } else if (holdMonths < 60) {
                        // 2-5å¹´ï¼š35%
                        taxRate = 0.35;
                        taxInfo = 'æŒæœ‰2-5å¹´';
                    } else if (holdMonths < 120) {
                        // 5-10å¹´ï¼š20%
                        taxRate = 0.20;
                        taxInfo = 'æŒæœ‰5-10å¹´';
                    } else {
                        // 10å¹´ä»¥ä¸Šï¼š15%
                        taxRate = 0.15;
                        taxInfo = 'æŒæœ‰10å¹´ä»¥ä¸Š';
                    }
                    capitalGainsTax = profit * taxRate;
                }
            }
            
            // è¨ˆç®—å¯¦éš›æ·¨æ”¶å…¥ï¼ˆæ‰£é™¤è²¸æ¬¾é¤˜é¡ã€è²»ç”¨ã€ç¨…è²»ï¼‰
            const netIncome = availableFunds - totalFees - capitalGainsTax;
            
            // è¨ˆç®—å ±é…¬ç‡
            const totalReturn = ((salePrice - purchasePrice) / purchasePrice) * 100;
            const annualReturn = holdYears > 0 ? (Math.pow(salePrice / purchasePrice, 1 / holdYears) - 1) * 100 : 0;
            
            const results = `
                <div class="space-y-4">
                    <div class="bg-white rounded-lg p-4 border-l-4 border-blue-500">
                        <h4 class="font-semibold text-blue-800 mb-2">ğŸ’° æˆ¿å±‹äº¤æ˜“è³‡è¨Š</h4>
                        <div class="grid grid-cols-2 gap-2 text-sm">
                            <div>å”®åƒ¹ï¼š</div>
                            <div class="font-semibold text-lg">${(salePrice / 10000).toFixed(1)} è¬å…ƒ</div>
                            <div>è³¼å…¥åƒ¹ï¼š</div>
                            <div class="font-semibold text-lg">${(purchasePrice / 10000).toFixed(1)} è¬å…ƒ</div>
                            <div>è²¸æ¬¾é¤˜é¡ï¼š</div>
                            <div class="font-semibold text-red-600">${(loanBalance / 10000).toFixed(1)} è¬å…ƒ</div>
                            <div>å¯ç”¨è³‡é‡‘ï¼š</div>
                            <div class="font-semibold text-blue-600">${(availableFunds / 10000).toFixed(1)} è¬å…ƒ</div>
                            <div>æŒæœ‰æœŸé–“ï¼š</div>
                            <div class="font-semibold">${holdYears} å¹´</div>
                            <div>åƒ¹å·®ç²åˆ©ï¼š</div>
                            <div class="font-semibold ${profit > 0 ? 'text-green-600' : 'text-red-600'}">${(profit / 10000).toFixed(1)} è¬å…ƒ</div>
                            <div>ç¸½å ±é…¬ç‡ï¼š</div>
                            <div class="font-semibold ${totalReturn > 0 ? 'text-green-600' : 'text-red-600'}">${totalReturn.toFixed(1)}%</div>
                            <div>å¹´åŒ–å ±é…¬ï¼š</div>
                            <div class="font-semibold ${annualReturn > 0 ? 'text-green-600' : 'text-red-600'}">${annualReturn.toFixed(1)}%</div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4 border-l-4 border-red-500">
                        <h4 class="font-semibold text-red-800 mb-2">ğŸ›ï¸ æˆ¿åœ°åˆä¸€ç¨…è¨ˆç®—</h4>
                        <div class="grid grid-cols-2 gap-2 text-sm mb-3">
                            <div>æŒæœ‰æœŸé–“ï¼š</div>
                            <div class="font-semibold">${taxInfo}</div>
                            <div>é©ç”¨ç¨…ç‡ï¼š</div>
                            <div class="font-semibold text-red-600">${(taxRate * 100).toFixed(0)}%</div>
                            <div>æ‡‰ç¨…æ‰€å¾—ï¼š</div>
                            <div class="font-semibold">${(profit / 10000).toFixed(1)} è¬å…ƒ</div>
                            ${taxExemption > 0 ? `
                            <div>å…ç¨…é¡ï¼š</div>
                            <div class="font-semibold text-green-600">${(taxExemption / 10000).toFixed(0)} è¬å…ƒ</div>
                            ` : ''}
                            <div>æˆ¿åœ°åˆä¸€ç¨…ï¼š</div>
                            <div class="font-semibold text-red-600 text-lg">${Math.round(capitalGainsTax).toLocaleString()} å…ƒ</div>
                        </div>
                        <div class="bg-red-50 p-3 rounded-lg text-xs">
                            <p class="font-semibold text-red-800 mb-1">ğŸ“‹ æˆ¿åœ°åˆä¸€ç¨…2.0èªªæ˜ï¼š</p>
                            <p>â€¢ æœªæ»¿2å¹´ï¼š45% | 2-5å¹´ï¼š35% | 5-10å¹´ï¼š20% | 10å¹´ä»¥ä¸Šï¼š15%</p>
                            <p>â€¢ è‡ªä½æ»¿6å¹´+è¨­ç±+ç„¡å‡ºç§Ÿï¼š400è¬å…ç¨…é¡ï¼Œè¶…ééƒ¨åˆ†10%</p>
                            <p>â€¢ è‡ªä½æ»¿6å¹´ä½†æœ‰å‡ºç§Ÿï¼šæŒ‰ä¸€èˆ¬ç¨…ç‡è¨ˆç®—ï¼Œç„¡å…ç¨…é¡</p>
                            <p>â€¢ è™§æä¸èª²ç¨… | éœ€å…ˆå„Ÿé‚„è²¸æ¬¾é¤˜é¡</p>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4 border-l-4 border-amber-500">
                        <h4 class="font-semibold text-amber-800 mb-2">ğŸ“‹ äº¤æ˜“è²»ç”¨æ˜ç´°</h4>
                        <div class="grid grid-cols-2 gap-2 text-sm">
                            <div>ä»²ä»‹è²» (${(agentRate * 100).toFixed(1)}%)ï¼š</div>
                            <div class="font-semibold">${Math.round(agentFee).toLocaleString()} å…ƒ</div>
                            <div>å…¬è­‰è²»ï¼š</div>
                            <div class="font-semibold">${notaryFee.toLocaleString()} å…ƒ</div>
                            <div>ä»£æ›¸è²»ï¼š</div>
                            <div class="font-semibold">${serviceFee.toLocaleString()} å…ƒ</div>
                            <div>å…¶ä»–è²»ç”¨ï¼š</div>
                            <div class="font-semibold">${otherFees.toLocaleString()} å…ƒ</div>
                            <div class="font-bold text-lg">è²»ç”¨ç¸½è¨ˆï¼š</div>
                            <div class="font-bold text-lg text-red-600">${Math.round(totalFees).toLocaleString()} å…ƒ</div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-lg p-6 text-center">
                        <h3 class="text-xl font-bold mb-2">ğŸ¯ å”®å±‹å¾Œå–å›é‡‘é¡</h3>
                        <div class="text-3xl font-bold">${(netIncome / 10000).toFixed(1)} è¬å…ƒ</div>
                        <p class="text-sm opacity-90 mt-2">æ‰£é™¤ç¨…è²»å¾Œçš„å¯¦éš›æ”¶å…¥</p>
                    </div>
                    
                    <div class="bg-gradient-to-r from-green-500 to-teal-500 text-white rounded-lg p-6 text-center">
                        <h3 class="text-xl font-bold mb-2">ğŸ’¹ æŠ•è³‡æ•ˆç›Šåˆ†æ</h3>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div>
                                <div class="text-2xl font-bold">${totalReturn.toFixed(1)}%</div>
                                <p class="opacity-90">ç¸½å ±é…¬ç‡</p>
                            </div>
                            <div>
                                <div class="text-2xl font-bold">${annualReturn.toFixed(1)}%</div>
                                <p class="opacity-90">å¹´åŒ–å ±é…¬</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('seller-results').innerHTML = results;
        }
        
        // ç´—çª—è¨ˆç®—åŠŸèƒ½
        function calculateScreen() {
            const type = document.getElementById('screenType').value;
            const width = parseFloat(document.getElementById('screenWidth').value);
            const height = parseFloat(document.getElementById('screenHeight').value);
            const quantity = parseInt(document.getElementById('screenQuantity').value);
            const grade = document.getElementById('materialGrade').value;
            
            if (!width || !height) {
                alert('è«‹è¼¸å…¥ç´—çª—å°ºå¯¸');
                return;
            }
            
            const area = width * height / 10000; // è½‰æ›ç‚ºå¹³æ–¹å…¬å°º
            
            // åŸºç¤åƒ¹æ ¼ï¼ˆæ¯å¹³æ–¹å…¬å°ºï¼‰
            let basePrice = 0;
            let typeName = '';
            
            switch(type) {
                case 'normal':
                    basePrice = 800;
                    typeName = 'å¹³ç´—çª—';
                    break;
                case 'roller':
                    basePrice = 1200;
                    typeName = 'æ²ç°¾ç´—çª—';
                    break;
                case 'magnetic':
                    basePrice = 1000;
                    typeName = 'ç£å¸ç´—çª—';
                    break;
                case 'folding':
                    basePrice = 1500;
                    typeName = 'æŠ˜ç–Šç´—çª—';
                    break;
            }
            
            // æè³ªç­‰ç´šåŠ åƒ¹
            let gradeMultiplier = 1;
            let gradeName = '';
            
            switch(grade) {
                case 'standard':
                    gradeMultiplier = 1;
                    gradeName = 'æ¨™æº–ç´š';
                    break;
                case 'premium':
                    gradeMultiplier = 1.5;
                    gradeName = 'é«˜ç´š';
                    break;
                case 'luxury':
                    gradeMultiplier = 2;
                    gradeName = 'è±ªè¯ç´š';
                    break;
            }
            
            const unitPrice = basePrice * gradeMultiplier;
            const totalPrice = area * unitPrice * quantity;
            
            const results = `
                <div class="space-y-4">
                    <div class="bg-white rounded-lg p-4 border-l-4 border-amber-500">
                        <h4 class="font-semibold text-amber-800 mb-2">ğŸ“ è¦æ ¼è³‡è¨Š</h4>
                        <div class="grid grid-cols-2 gap-2 text-sm">
                            <div>ç´—çª—é¡å‹ï¼š</div>
                            <div class="font-semibold">${typeName}</div>
                            <div>å°ºå¯¸ï¼š</div>
                            <div class="font-semibold">${width} Ã— ${height} cm</div>
                            <div>é¢ç©ï¼š</div>
                            <div class="font-semibold">${area.toFixed(2)} å¹³æ–¹å…¬å°º</div>
                            <div>æ•¸é‡ï¼š</div>
                            <div class="font-semibold">${quantity} å€‹</div>
                            <div>æè³ªç­‰ç´šï¼š</div>
                            <div class="font-semibold">${gradeName}</div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4 border-l-4 border-green-500">
                        <h4 class="font-semibold text-green-800 mb-2">ğŸ’° åƒ¹æ ¼è¨ˆç®—</h4>
                        <div class="grid grid-cols-2 gap-2 text-sm">
                            <div>åŸºç¤å–®åƒ¹ï¼š</div>
                            <div class="font-semibold">${basePrice} å…ƒ/ã¡</div>
                            <div>ç­‰ç´šå€æ•¸ï¼š</div>
                            <div class="font-semibold">${gradeMultiplier}x</div>
                            <div>å¯¦éš›å–®åƒ¹ï¼š</div>
                            <div class="font-semibold">${unitPrice.toFixed(0)} å…ƒ/ã¡</div>
                            <div>å–®å€‹åƒ¹æ ¼ï¼š</div>
                            <div class="font-semibold">${Math.round(area * unitPrice).toLocaleString()} å…ƒ</div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-r from-amber-500 to-orange-500 text-white rounded-lg p-6 text-center">
                        <h3 class="text-xl font-bold mb-2">ğŸ¯ ç¸½å ±åƒ¹</h3>
                        <div class="text-3xl font-bold">${Math.round(totalPrice).toLocaleString()} å…ƒ</div>
                        <p class="text-sm opacity-90 mt-2">å«å®‰è£åŠåŸºæœ¬é…ä»¶</p>
                    </div>
                    
                    <div class="bg-blue-50 rounded-lg p-4">
                        <h4 class="font-semibold text-blue-800 mb-2">ğŸ“ å‚™è¨»èªªæ˜</h4>
                        <ul class="text-sm text-gray-600 space-y-1">
                            <li>â€¢ åƒ¹æ ¼åŒ…å«åŸºæœ¬å®‰è£æœå‹™</li>
                            <li>â€¢ ç‰¹æ®Šå°ºå¯¸éœ€ç¾å ´ä¸ˆé‡ç¢ºèª</li>
                            <li>â€¢ å¦‚éœ€é¡å¤–é…ä»¶å¦è¨ˆ</li>
                            <li>â€¢ ä¿å›ºæœŸé–“ï¼š1å¹´</li>
                        </ul>
                    </div>
                </div>
            `;
            
            document.getElementById('screen-results').innerHTML = results;
        }
        
        // æ·±è‰²æ¨¡å¼åŠŸèƒ½
        function toggleDarkMode() {
            const body = document.body;
            const icon = document.getElementById('dark-mode-icon');
            
            if (body.classList.contains('dark-mode')) {
                body.classList.remove('dark-mode');
                icon.textContent = 'ğŸŒ™';
                localStorage.setItem('darkMode', 'false');
            } else {
                body.classList.add('dark-mode');
                icon.textContent = 'â˜€ï¸';
                localStorage.setItem('darkMode', 'true');
            }
        }
        
        // å°å‡ºçµæœåŠŸèƒ½
        function exportResults() {
            const results = document.querySelector('.calculator-section.active #buyer-results, .calculator-section.active #seller-results, .calculator-section.active #screen-results');
            if (results && results.innerHTML.includes('ç¸½')) {
                const content = results.innerText;
                const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'æˆ¿ç”¢è¨ˆç®—çµæœ.txt';
                a.click();
                URL.revokeObjectURL(url);
            } else {
                alert('è«‹å…ˆå®Œæˆè¨ˆç®—ä»¥å°å‡ºçµæœ');
            }
        }
        
        // é¡¯ç¤ºèªªæ˜
        function showHelp() {
            alert(`ğŸ  æˆ¿ç”¢è²»ç”¨æ™ºæ…§ä¼°ç®—ä¸­å¿ƒ - ä½¿ç”¨èªªæ˜

ğŸ§® è²·æ–¹ä¼°ç®—ï¼š
â€¢ è¼¸å…¥æˆ¿å±‹ç¸½åƒ¹
â€¢ èª¿æ•´è²¸æ¬¾æˆæ•¸ã€å¹´é™ã€åˆ©ç‡
â€¢ å¡«å¯«é›œé …è²»ç”¨
â€¢ ç²å¾—ç¸½è³¼å±‹æˆæœ¬

ğŸ“ˆ è³£æ–¹ä¼°ç®—ï¼š
â€¢ è¼¸å…¥å”®åƒ¹å’Œè³¼å…¥åƒ¹æ ¼
â€¢ è¨­å®šæŒæœ‰æœŸé–“
â€¢ è¨ˆç®—æˆ¿åœ°åˆä¸€ç¨…
â€¢ ç²å¾—æ·¨æ”¶å…¥

âœ¨ ç´—çª—å ±åƒ¹ï¼š
â€¢ é¸æ“‡ç´—çª—é¡å‹
â€¢ è¼¸å…¥å°ºå¯¸å’Œæ•¸é‡
â€¢ é¸æ“‡æè³ªç­‰ç´š
â€¢ ç”Ÿæˆå°ˆæ¥­å ±åƒ¹

ğŸ’¡ å°æŠ€å·§ï¼š
â€¢ ä½¿ç”¨æ»‘æ¡¿èª¿æ•´æ•¸å€¼
â€¢ çµæœæœƒå³æ™‚æ›´æ–°
â€¢ æ”¯æ´å°å‡ºè¨ˆç®—çµæœ
â€¢ å¯åˆ‡æ›æ·±è‰²æ¨¡å¼`);
        }
        
        // å‰µå»ºåœ–è¡¨
        function createChart(type, data, containerId) {
            const ctx = document.getElementById(containerId);
            if (!ctx) return;
            
            new Chart(ctx, {
                type: type,
                data: data,
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: 'è²»ç”¨åˆ†æåœ–è¡¨'
                        }
                    }
                }
            });
        }
        
        // å„ªåŒ–çš„è²·æ–¹è¨ˆç®—åŠŸèƒ½ï¼ˆæ·»åŠ åœ–è¡¨ï¼‰
        function calculateBuyerWithChart() {
            calculateBuyer();
            
            // æ·»åŠ åœ–è¡¨
            setTimeout(() => {
                const resultsContainer = document.getElementById('buyer-results');
                const chartContainer = document.createElement('div');
                chartContainer.innerHTML = `
                    <div class="mt-6">
                        <h4 class="font-semibold mb-3">ğŸ“Š è²»ç”¨åˆ†æåœ–è¡¨</h4>
                        <canvas id="buyerChart" width="400" height="200"></canvas>
                    </div>
                `;
                resultsContainer.appendChild(chartContainer);
                
                // ç²å–æ•¸æ“š
                const housePrice = parseFloat(document.getElementById('housePrice').value) * 10000;
                const totalFees = parseFloat(document.getElementById('serviceFee').value || 0) + 
                                parseFloat(document.getElementById('notaryFee').value || 0) + 
                                parseFloat(document.getElementById('agentFee').value || 0) + 
                                parseFloat(document.getElementById('contractTax').value || 0);
                
                if (housePrice > 0) {
                    const chartData = {
                        labels: ['æˆ¿å±‹åƒ¹æ ¼', 'é›œé …è²»ç”¨'],
                        datasets: [{
                            data: [housePrice, totalFees],
                            backgroundColor: ['#10b981', '#3b82f6'],
                            borderWidth: 2
                        }]
                    };
                    createChart('pie', chartData, 'buyerChart');
                }
            }, 100);
        }
        
        // ç¶å®šæ—¥æœŸè®Šæ›´äº‹ä»¶
        function bindDateEvents() {
            const purchaseDateInput = document.getElementById('purchaseDate');
            const saleDateInput = document.getElementById('saleDate');
            
            function calculateHoldYears() {
                const purchaseDate = purchaseDateInput.value;
                const saleDate = saleDateInput.value;
                
                if (purchaseDate && saleDate) {
                    const purchase = new Date(purchaseDate);
                    const sale = new Date(saleDate);
                    
                    if (sale > purchase) {
                        const diffTime = sale - purchase;
                        const diffYears = diffTime / (1000 * 60 * 60 * 24 * 365.25);
                        document.getElementById('holdYears').value = diffYears.toFixed(2) + ' å¹´';
                    } else {
                        document.getElementById('holdYears').value = 'å‡ºå”®æ—¥æœŸå¿…é ˆæ™šæ–¼è³¼å…¥æ—¥æœŸ';
                    }
                } else {
                    document.getElementById('holdYears').value = 'è«‹é¸æ“‡è³¼å…¥å’Œå‡ºå”®æ—¥æœŸ';
                }
            }
            
            purchaseDateInput.addEventListener('change', calculateHoldYears);
            saleDateInput.addEventListener('change', calculateHoldYears);
        }
        
        // é é¢è¼‰å…¥å®Œæˆå¾Œçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // é è¨­é¡¯ç¤ºæ­¡è¿é é¢
            showWelcome();
            
            // è¼‰å…¥æ·±è‰²æ¨¡å¼è¨­å®š
            if (localStorage.getItem('darkMode') === 'true') {
                document.body.classList.add('dark-mode');
                document.getElementById('dark-mode-icon').textContent = 'â˜€ï¸';
            }
            
            // ç¶å®šæ—¥æœŸè®Šæ›´äº‹ä»¶
            bindDateEvents();
            
            // æ·»åŠ è¼¸å…¥æ¡†èšç„¦æ•ˆæœ
            document.querySelectorAll('input').forEach(input => {
                input.addEventListener('focus', function() {
                    this.classList.add('input-focus');
                });
                input.addEventListener('blur', function() {
                    this.classList.remove('input-focus');
                });
            });
            
            // æ·»åŠ éµç›¤å¿«æ·éµ
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey) {
                    switch(e.key) {
                        case '1':
                            e.preventDefault();
                            showCalculator('buyer');
                            break;
                        case '2':
                            e.preventDefault();
                            showCalculator('seller');
                            break;
                        case '3':
                            e.preventDefault();
                            showCalculator('screen');
                            break;
                        case 'h':
                            e.preventDefault();
                            showHelp();
                            break;
                    }
                }
            });
        });
    </script>
</body>
</html>
